---
title: "R Notebook"
output: 
  html_notebook: 
    code_folding: hide
---

To execute: *Ctrl+Shift+Enter*.

To add a new chunk: *Ctrl+Alt+I*

To preview the HTML file: C*trl+Shift+K*

# Distribuciones

## Ji Cuadrada

```{r}
# El cuantil de la distribución ji-cuadrada con 13 grados de libertad que deja una probabilidad igual a 0.1 en la cola derecha de la distribución
cuantil_10_derecho = qchisq(0.1, 13, lower.tail=FALSE)
cuantil_10_derecho

# qchisq(alpha, v, ...)
# pchisq(cuantil, v, ...)

cuantil_derecho = qchisq(0.1, 13, lower.tail=FALSE)
cuantil_derecho

cuantil_izquierdo = qchisq(0.1, 13, lower.tail=TRUE)
cuantil_izquierdo

probabilidad_derecha = pchisq(0.1, 13, lower.tail=FALSE)
probabilidad_derecha

probabilidad_izquierda = pchisq(0.1, 13, lower.tail=TRUE)
probabilidad_izquierda
```

## T de Student

```{r}
# El cuantil de la distribución t de Student con 13 grados de libertad que deja una probabilidad igual a 0.05 en la cola derecha de la distribución
cuantil_05_derecho = qt(0.5, 13, lower.tail=TRUE)
cuantil_05_derecho

# qt(alpha, v, ...)
# pt(cuantil, v, ...)

cuantil_derecho = qt(0.5, 13, lower.tail=FALSE)
cuantil_derecho

cuantil_izquierdo = qt(0.5, 13, lower.tail=TRUE)
cuantil_izquierdo

probabilidad_derecha = pt(0.5, 13, lower.tail=FALSE)
probabilidad_derecha

probabilidad_izquierda = pt(0.5, 13, lower.tail=TRUE)
probabilidad_izquierda
```

## F de Fisher

```{r}
# El cuantil de la distribución F con 5 y 10 grados de libertad que deja una probabilidad igual a 0.01 en la cola derecha de la distribución
cuantil_01_derecho = qf(0.01, 5, 10, lower.tail=FALSE)
cuantil_01_derecho

# qf(alpha, m, n, ...)
# pf(cuantil, m, n, ...)

cuantil_derecho = qf(0.01, 5, 10, lower.tail=FALSE)
cuantil_derecho

cuantil_izquierdo = qf(0.01, 5, 10, lower.tail=TRUE)
cuantil_izquierdo

probabilidad_derecha = pf(0.01, 5, 10, lower.tail=FALSE)
probabilidad_derecha

probabilidad_izquierda = pf(0.01, 5, 10, lower.tail=TRUE)
probabilidad_izquierda
```

# Intervalos de confianza

## Media

### Sigma conocida

```{r}
IC_mu_sigma_conocida = function(x_barra, sigma, n, coef_conf) {
  alfa = 1 - coef_conf
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  
  LIC = x_barra - z_alfa_medios*sigma/sqrt(n)
  LSC = x_barra + z_alfa_medios*sigma/sqrt(n)
  
  resultado = list(lim_inf_conf=LIC, lim_sup_conf=LSC)
  
  return(resultado)
}

x_barra = 1458      #Media
sigma = 2           #Desviación estándar
n = 36              #Tamaño de muestra
coefConf = 0.95     #Coeficiente de confianza

IC1 = IC_mu_sigma_conocida(x_barra, sigma, n, coefConf)
IC1
```

### Sigma desconocida

```{r}
IC_mu_sigma_desconocida = function(x_barra, s, n, coef_conf) 
  {
  alfa = 1 - coef_conf
  
  t = qt(alfa/2,n-1,lower.tail=FALSE)
  
  LIC = x_barra - t*s/sqrt(n)
  LSC = x_barra + t*s/sqrt(n)
  
  resultado = list(lim_inf_conf = LIC, lim_sup_conf = LSC)
  
  return(resultado)
}

#datos = c(15.0,20.6,16.0,12.8,14.1,86.1,7.5,0.9,6.0,26.2,4.2,3.0,2.4,66.9,4.7,29.0,95.1,2.7,29.7,10.9)
datos = c(37.0,16.0,60.5,84.4,85.9,1.9,12.1,3.2,30.2,15.7,43.1,9.2,0.4,28.4,82.4,10.4,10.0,85.5,14.6,9.4)
datos

x_barra = 1458        #Media
n = 36                #Tamaño de muestra
coefConf = 0.95       #Coeficiente de confianza

s = sqrt(var(datos))  #Desviación estándar obtenida de la varianza
s

IC1 = IC_mu_sigma_desconocida(x_barra, s, n, coefConf)
IC1
```

## Proporción

```{r}
proporcion = function(x, n, coef_conf) 
{
  alfa = 1 - coef_conf
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  p_gorro = x/n
  
  LIC = p_gorro - z_alfa_medios*sqrt(p_gorro*(1 - p_gorro)/n)
  LSC = p_gorro + z_alfa_medios*sqrt(p_gorro*(1 - p_gorro)/n)
  
  resultado = list(lim_inf_conf=LIC, lim_sup_conf=LSC)
  
  return(resultado)
}

# En una encuesta a los estudiantes de la Universidad se preguntó a 85 de ellos si había reprobado algún examen en el periodo anterior
# Suponga que 8 de ellos respondieron afirmativamente
# Calcule un intervalo de confianza de 95% para la verdadera proporción de estudiantes que reprobó algún examen en el periodo anterior
# R: P([0.032,0.156] ni p) = 0.95

x = 8               #Cantidad de elementos que cumplen una característica
n = 85              #Tamaño de la muestra
coefConf = 0.95     #Coeficiente de confianza

ICP1 = proporcion(x, n, coefConf)
ICP1
```

## Varianza

```{r}
varianza = function(desv_std, n, coef_conf) {
  alfa = 1 - coef_conf
  ji2_alfa_medios = qchisq(alfa/2, n-1, lower.tail=FALSE)
  ji2_1_menos_alfa_medios = qchisq(1 - alfa/2, n-1, lower.tail=FALSE)
  
  LIC = (n-1)*desv_std^2/ji2_alfa_medios
  LSC = (n-1)*desv_std^2/ji2_1_menos_alfa_medios
  
  resultado = list(lim_inf_conf=LIC, lim_sup_conf=LSC)
  
  return(resultado)
}

# Suponga que cierta máquina fabrica resistencias eléctricas cuyo valor sigue una distribución normal con una desviación estándar por determinar
# Una muestra de tamaño 36 produce una resistencia que tiene una desviación estándar de 1.8
# Obtenga un Intervalo de Confianza de 99% para la verdadera varianza de las resistencias

n = 36            #Tamaño de la muestra
s = 1.8           #Desvaición estándar
coefConf = 0.99   #Coeficiente de confianza

IC1_var = varianza(s, n, coefConf)
IC1_var
```

## Diferencia de medias

### Sigma conocida

```{r}
diferencia_de_medias = function(x_barra1, n1, sigma1, x_barra2, n2, sigma2, coef_conf) {
  alfa = 1 - coef_conf
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  
  LIC = (x_barra1 - x_barra2) - z_alfa_medios*sqrt(sigma1^2/n1 + sigma2^2/n2)
  LSC = (x_barra1 - x_barra2) + z_alfa_medios*sqrt(sigma1^2/n1 + sigma2^2/n2)
  
  resultado = list(lim_inf_conf=LIC, lim_sup_conf=LSC)
  
  return(resultado)
}

# En un artículo de Consumer Reports de noviembre de 1983 se comparan varios tipos de baterías
# Los tiempos de vida promedio de baterías AA alcalinas Duracell y baterías AA alcalinas Eveready Energizer se dieron como 4.1 horas y 4.5 horas, respectivamente
# En ambos casos, la muestra fue de 100 baterías
# Suponga que las desviaciones estándar poblacionales del tiempo de vida son 1.8 horas para las baterías Duracell y 2.0 para las baterías Eveready Energizer
# Calcule un IC de 90% para la diferencia entre los tiempos promedio de vida de ambos tipos de baterías
# R = P([-0.843, 0.043] ni (mu1 - mu2)) = 0.90

x_barra1 = 4.1    #Media aritmética de la muestra 1
x_barra2 = 4.5    #Media aritmética de la muestra 2
n1 = 100          #Tamaño de la muestra 1
n2 = 100          #Tamaño de la muestra 2
sigma1 = 1.8      #Sigma de la muestra 1
sigma2 = 2        #Sigma de la muestra 2
coefConf = 0.9    #Coeficiente de confianza

IC1_mu1_mu2 = diferencia_de_medias(x_barra1, n1, sigma1, x_barra2, n2, sigma2, coefConf)
IC1_mu1_mu2
```

### Sigma desconocida; sigma igual

```{r}
diferencia_de_medias_desconocida = function(x_barra1,s1,n1,x_barra2,s2,n2,coefConf=0.95) {
  alfa = 1 - coefConf
  alfaM = alfa/2

  m = n1 + n2 - 2
  t = qt(alfaM,m,lower.tail=FALSE)
  sp2 = ((n1-1)*s1 + (n2-1)*s2)/m
  LIC = (x_barra1 - x_barra2) - t*sqrt(sp2*(1/n1+1/n2))
  LSC = (x_barra1 - x_barra2) + t*sqrt(sp2*(1/n1+1/n2))

  resultado = list(lim_inf_conf = LIC, lim_sup_conf = LSC)
  
  return(resultado)
}

datos2 = c(15.0,20.6,16.0,12.8,14.1,86.1,7.5,0.9,6.0,26.2,4.2,3.0,2.4,66.9,4.7,29.0,95.1,2.7,29.7,10.9)
datos1 = c(37.0,16.0,60.5,84.4,85.9,1.9,12.1,3.2,30.2,15.7,43.1,9.2,0.4,28.4,82.4,10.4,10.0,85.5,14.6,9.4)

x_barra1 = 1458           #Media de la muestra 1
n1 = 36                   #Tamaño de muestra 1
x_barra2 = 1458           #Media de la muestra 2
n2 = 36                   #Tamaño de muestra 2
coefConf = 0.95           #Coeficiente de confianza

s1 = sqrt(var(datos1))    #Desviación estándar obtenida de la varianza de los datos 1
s1
s2 = sqrt(var(datos2))    #Desviación estándar obtenida de la varianza de los datos 2
s2

IC1 = diferencia_de_medias_desconocida(x_barra1,s1,n1,x_barra2,s2,n2,coefConf)
IC1
```

## Diferencia de proporciones

```{r}
diferencia_de_proporcion = function(x1, n1, x2, n2, coef_conf) 
{
  alfa = 1 - coef_conf
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  p_gorro1 = x1/n1
  p_gorro2 = x2/n2
  
  LIC = (p_gorro1 - p_gorro2) - z_alfa_medios*sqrt(p_gorro1*(1 - p_gorro1)/n1 + p_gorro2*(1 - p_gorro2)/n2)
  LSC = (p_gorro1 - p_gorro2) + z_alfa_medios*sqrt(p_gorro1*(1 - p_gorro1)/n1 + p_gorro2*(1 - p_gorro2)/n2)
  
  resultado = list(lim_inf_conf=LIC, lim_sup_conf=LSC)
  
  return(resultado)
}

#Una compañía de insumos para la industria informática fabrica gabinetes con dos terminados distintos.
#Se tomó una muestra aleatoria de 85 gabinetes de tipo 1, de los cuales 10 tenían una rugosidad superior 
#a la indicada por las especificaciones. Por otro lado, 8 gabinetes de una muestra de 85 piezas de tipo 2 
#tenían una rugosidad superior a la especificada. Obtenga una estimación por intervalo con un 
#coeficiente de confianza de 95% para la diferencia entre las proporciones de gabinetes de tipo 1 y 2 
#cuya rugosidad supera las especificaciones

x1 = 10             #Cantidad de elementos que cumplen una característica en la muestra 1
x2 = 8              #Cantidad de elementos que cumplen una característica en la muestra 2
n1 = 85             #Tamaño de la muestra 1
n2 = 85             #Tamaño de la muestra 2
coefConf = 0.95     #Coeficiente de confianza

ICP1 = diferencia_de_proporcion(x1, n1, x2, n2, coefConf)
ICP1
```

## Razón de varianzas

```{r}
varianza = function(desv_std1, n1, desv_std2, n2, coef_conf) {
  alfa = 1 - coef_conf
  f_n1_n2 = qf(alfa/2, n1 - 1, n2 - 1, lower.tail=FALSE)
  f_n2_n1 = qf(alfa/2, n2 - 1, n1 - 1, lower.tail=FALSE)
  
  LIC = (desv_std1^2/desv_std2^2)*(1/f_n1_n2)
  LSC = (desv_std1^2/desv_std2^2)*(f_n2_n1)
  
  resultado = list(lim_inf_conf=LIC, lim_sup_conf=LSC)
  
  return(resultado)
}

n1 = 36            #Tamaño de la muestra 1
n2 = 38            #Tamaño de la muestra 2
s1 = 1.3           #Desvaición estándar de la muestra 1
s2 = 1.8           #Desvaición estándar de la muestra 2
coefConf = 0.99   #Coeficiente de confianza

IC1_var = varianza(s1, n1, s2, n2, coefConf)
IC1_var
```

# Contraste de hipotesis

## Media

### Sigma conocida

```{r}
media_sigma_conocida = function(x_barra, sigma, n, alfa, mu0, condicion = 0) {
  z_calc = (x_barra - mu0)/(sigma/sqrt(n))
  print(paste("Zcalc = ", z_calc))
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  z_alfa = qnorm(alfa, lower.tail=FALSE)
  menos_z_alfa = -z_alfa

  if(condicion == 0)
  {
    print(paste("-Zalfa = ", menos_z_alfa))
    if(z_calc < menos_z_alfa) resultado = TRUE
    else resultado = FALSE
  }
  else if (condicion == 1)
  {
    print(paste("Zalfa = ", z_alfa))
    if(z_calc > z_alfa) resultado = TRUE
    else resultado = FALSE
  }
  else
  {
    print(paste("Zalfa/2 = ", z_alfa_medios))

    if(abs(z_calc) > z_alfa_medios) resultado = TRUE
    else resultado = FALSE
  }
  
  return(resultado)
}

mu0 = 8             #Valor esperado
x_barra = 7.909     #Media de la muestra
sigma = 0.16        #Desviación estándar de la muestra
n = 30              #Tamaño de muestra
alfa = 0.01         #Probabilidad de cometer un error tipo 1
condicion = 0       #Condición de rechazo de la hipótesis (0 = z_calc < menos_z_alfa;1 = z_calc > z_alfa; 2 = abs(z_calc) > z_alfa_medios)

rechazo = media_sigma_conocida(x_barra, sigma, n, alfa, mu0, condicion)
rechazo
```

### Sigma desconocida

```{r}
media_sigma_desconocida = function(x_barra, s, n, alfa, mu0, condicion)
  {
    t_calc = (x_barra - mu0)/(s/sqrt(n))
    print(paste("Tcalc = ", t_calc))
    t_alfa_medios = qt(alfa/2,n-1,lower.tail=FALSE)
    t_alfa = qt(alfa,n-1,lower.tail=FALSE)
    menos_t_alfa = -t_alfa

    if(condicion == 0)
    {
      print(paste("-Talfa = ", menos_t_alfa))
      if(t_calc < menos_t_alfa) resultado = TRUE
      else resultado = FALSE
    }
    else if (condicion == 1)
    {
      print(paste("Talfa = ", t_alfa))
      if(t_calc > t_alfa) resultado = TRUE
      else resultado = FALSE
    }
    else
    {
      print(paste("Talfa/2 = ", t_alfa_medios))
      if(abs(t_calc) > t_alfa_medios) resultado = TRUE
      else resultado = FALSE
    }
    
    return(resultado)
  
  return(resultado)
}

datos = c(20.7,27.46,22.15,19.85,21.29,24.75,20.75,22.91,25.34,20.33,21.54,21.08,22.14,19.56,21.1,18.04,24.12,19.95,19.72,18.28,16.26,17.46,20.53,22.12,25.06,22.44,19.08,19.88,21.39,22.33,25.79)

mu0 = 22000              #Valor esperado
x_barra = 21819        #Media de la muestra
n = 100                #Tamaño de muestra
alfa = 0.01           #Probabilidad de cometer un error tipo 1
#s = sqrt(var(datos))  #Desviación estándar de los datos (obtenida)
s = 1295              #Desviación estándar de los datos (definida)
condicion = 0         #Condición de rechazo de la hipótesis (0 = t_calc < menos_t_alfa;1 = t_calc > t_alfa; 2 = abs(t_calc) > t_alfa_medios)

rechazo = media_sigma_desconocida(x_barra, s, n, alfa, mu0, condicion)
rechazo
```

## Proporcion

```{r}
proporcion = function(x, n, alfa, p0, condicion = 0) {
  p_gorro = x/n
  z_calc = (p_gorro - p0)/sqrt((p0*(1 - p0))/n)
  print(paste("Zcalc = ", z_calc))
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  z_alfa = qnorm(alfa, lower.tail=FALSE)
  menos_z_alfa = -z_alfa

  if(condicion == 0)
  {
    print(paste("-Zalfa = ", menos_z_alfa))
    if(z_calc < menos_z_alfa) resultado = TRUE
    else resultado = FALSE
  }
  else if (condicion == 1)
  {
    print(paste("Zalfa = ", z_alfa))
    if(z_calc > z_alfa) resultado = TRUE
    else resultado = FALSE
  }
  else
  {
    print(paste("Zalfa/2 = ", z_alfa_medios))

    if(abs(z_calc) > z_alfa_medios) resultado = TRUE
    else resultado = FALSE
  }
  
  return(resultado)
}

p0 = 0.80           #Proporción esperada
x = 178             #Cantidad de elementos que cumplen una característica
n = 200             #Tamaño de la muestra
alfa = 0.05         #Probabilidad de cometer un error tipo 1
condicion = 2       #Condición de rechazo de la hipótesis (0 = z_calc < menos_z_alfa;1 = z_calc > z_alfa; 2 = abs(z_calc) > z_alfa_medios)

rechazo = proporcion(x, n, alfa, p0, condicion) 
rechazo
```

## Varianza

```{r}
proporcion = function(x, n, alfa, p0, condicion = 0) {
  p_gorro = x/n
  z_calc = (p_gorro - p0)/sqrt((p0*(1 - p0))/n)
  print(paste("Zcalc = ", z_calc))
  z_alfa_medios = qnorm(alfa/2, lower.tail=FALSE)
  z_alfa = qnorm(alfa, lower.tail=FALSE)
  menos_z_alfa = -z_alfa

  if(condicion == 0)
  {
    print(paste("-Zalfa = ", menos_z_alfa))
    if(z_calc < menos_z_alfa) resultado = TRUE
    else resultado = FALSE
  }
  else if (condicion == 1)
  {
    print(paste("Zalfa = ", z_alfa))
    if(z_calc > z_alfa) resultado = TRUE
    else resultado = FALSE
  }
  else
  {
    print(paste("Zalfa/2 = ", z_alfa_medios))

    if(abs(z_calc) > z_alfa_medios) resultado = TRUE
    else resultado = FALSE
  }
  
  return(resultado)
}

p0 = 0.80           #Proporción esperada
x = 178             #Cantidad de elementos que cumplen una característica
n = 200             #Tamaño de la muestra
alfa = 0.05         #Probabilidad de cometer un error tipo 1
condicion = 2       #Condición de rechazo de la hipótesis (0 = z_calc < menos_z_alfa;1 = z_calc > z_alfa; 2 = abs(z_calc) > z_alfa_medios)

rechazo = proporcion(x, n, alfa, p0, condicion) 
rechazo
```
